(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{308:function(e,n,t){"use strict";t.r(n);var s=t(38),a=Object(s.a)({},function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"在-centos-7-上安装最新版-nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-centos-7-上安装最新版-nginx","aria-hidden":"true"}},[e._v("#")]),e._v(" 在 CentOS 7 上安装最新版 Nginx")]),e._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://segmentfault.com/a/1190000018109309",target:"_blank",rel:"noopener noreferrer"}},[e._v("原文链接"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"开始前的准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开始前的准备","aria-hidden":"true"}},[e._v("#")]),e._v(" 开始前的准备")]),e._v(" "),t("p",[e._v("在开始阅读此教程之前，请确保你是以拥有 sudo 权限的用户来登录的服务器，并且服务器中没有 Apache 或是其他服务正在使用 80（HTTP） 和 443（HTTPS） 端口上，防止端口被占用，造成 Nginx 无法正常启动。")]),e._v(" "),t("h2",{attrs:{id:"在-centos-中安装-nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-centos-中安装-nginx","aria-hidden":"true"}},[e._v("#")]),e._v(" 在 CentOS 中安装 Nginx")]),e._v(" "),t("p",[e._v("请按照下面的步骤，在 CentOS 中安装 Nginx。")]),e._v(" "),t("p",[e._v("1、 EPEL 仓库中有 Nginx 的安装包。如果你还没有安装过 EPEL，可以通过运行下面的命令来完成安装：")]),e._v(" "),t("p",[t("code",[e._v("sudo yum install epel-release")])]),e._v(" "),t("p",[e._v("上面代码的意思是以 sudo 权限运行安装 epel-release，如果你当前登录的用户不是 root，则会提示你输入密码来运行，输入密码时是看不到输入的内容的，所以不用担心，继续输入就行。然后回车继续运行，后面的命令中如果包含 sudo 则都表明是刚提到的意思，不再重复解释。")]),e._v(" "),t("p",[e._v("2、 输入以下命令来安装 Nginx：")]),e._v(" "),t("p",[t("code",[e._v("sudo yum install nginx")])]),e._v(" "),t("p",[e._v("如果这是您第一次从 EPEL 仓库中安装软件，yum 可能会提示您导入 EPEL GPG key：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7\nImporting GPG key 0x352C64E5:\nUserid     : "Fedora EPEL (7) <epel@fedoraproject.org>"\nFingerprint: 91e9 7d7c 4a5e 96f1 7f3e 888f 6a2f aea2 352c 64e5\nPackage    : epel-release-7-9.noarch (@extras)\nFrom       : /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7\nIs this ok [y/N]:\n\n')])])]),t("p",[e._v("类似于上面的内容，遇到这种情况，输入 y，然后 Enter（回车） 即可继续安装。")]),e._v(" "),t("p",[e._v("3、 等到安装完成以后，可以通过以下命令来设置开机启动和运行 Nginx 服务：")]),e._v(" "),t("p",[e._v("设置 Nginx 开机启动：")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl enable nginx")])]),e._v(" "),t("p",[e._v("运行以上命令以后，会输出类似以下的内容，表示创建了一个软连接来关联 Nginx，不用担心，并不是报错了，下一步就可以启动 Nginx 了。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Created symlink from /etc/systemd/system/multi-user.target.wants/nginx.service to /usr/lib/systemd/system/nginx.service.\n")])])]),t("p",[e._v("启动 Nginx：")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl start nginx")])]),e._v(" "),t("p",[e._v("通过运行以下命令，来检查 Nginx 的运行状态：")]),e._v(" "),t("p",[e._v("sudo systemctl status nginx\n然后会输出类型下面的内容")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("● nginx.service - The nginx HTTP and reverse proxy server\n  Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: disabled)\n  Active: active (running) since Mon 2018-03-12 16:12:48 UTC; 2s ago\n  Process: 1677 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)\n  Process: 1675 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=0/SUCCESS)\n  Process: 1673 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)\nMain PID: 1680 (nginx)\n  CGroup: /system.slice/nginx.service\n          ├─1680 nginx: master process /usr/sbin/nginx\n          └─1681 nginx: worker process\n")])])]),t("p",[e._v("4、 如果你的服务器开启了防火墙，则需要同时打开 80（HTTP）和 443（HTTPS）端口")]),e._v(" "),t("p",[e._v("通过下面的命令来打开这两个端口：")]),e._v(" "),t("p",[t("code",[e._v("sudo firewall-cmd --permanent --zone=public --add-service=http")])]),e._v(" "),t("p",[t("code",[e._v("sudo firewall-cmd --permanent --zone=public --add-service=https")])]),e._v(" "),t("p",[t("code",[e._v("sudo firewall-cmd --reload")])]),e._v(" "),t("p",[e._v("国内的服务器厂商，安全组也可能会默认屏蔽这两个端口，比如 阿里云 和 腾讯云，如果在 第 5 步 时发现无法访问，可以自行百度一下如何放开这两个端口。")]),e._v(" "),t("p",[e._v("5、 验证 Nginx 是否成功启动，可以在浏览器中打开 http://YOUR_IP，您将看到默认的 Nginx 欢迎页面，类似于下图所示：")]),e._v(" "),t("p",[t("code",[e._v("Welcome to Nginx")])]),e._v(" "),t("p",[e._v("注：Nginx 的默认欢迎页有好几种样式，和你安装的版本有关，所以大家只用关注这个页面的大标题就行了 Welcome to nginx！")]),e._v(" "),t("p",[e._v("通过 systemctl 管理 Nginx\n你可以像管理其他服务那样管理 Nginx。")]),e._v(" "),t("p",[e._v("启动 Nginx")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl start nginx")])]),e._v(" "),t("p",[e._v("停止 Nginx")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl stop nginx")])]),e._v(" "),t("p",[e._v("重启 Nginx")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl restart nginx")])]),e._v(" "),t("p",[e._v("修改 Nginx 配置后，重新加载")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl reload nginx")])]),e._v(" "),t("p",[e._v("设置开机启动 Nginx")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl enable nginx")])]),e._v(" "),t("p",[e._v("关闭开机启动 Nginx")]),e._v(" "),t("p",[t("code",[e._v("sudo systemctl disable nginx")])]),e._v(" "),t("h2",{attrs:{id:"nginx-的配置文件和最佳实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-的配置文件和最佳实践","aria-hidden":"true"}},[e._v("#")]),e._v(" Nginx 的配置文件和最佳实践")]),e._v(" "),t("p",[e._v("通过以上方式安装的 Nginx，所有相关的配置文件都在 "),t("code",[e._v("/etc/nginx/")]),e._v(" 目录中。\nNginx 的主配置文件是 "),t("code",[e._v("/etc/nginx/nginx.conf")]),e._v("。")]),e._v(" "),t("p",[e._v("为了使 Nginx 配置更易于维护，建议为每个服务（域名）创建一个单独的配置文件。\n每一个独立的 Nginx 服务配置文件都必须以 .conf 结尾，并存储在 "),t("code",[e._v("/etc/nginx/conf.d")]),e._v("目录中。您可以根据需求，创建任意多个独立的配置文件。")]),e._v(" "),t("p",[e._v("独立的配置文件，建议遵循以下命名约定，比如你的域名是 "),t("code",[e._v("kaifazhinan.com")]),e._v("，那么你的配置文件的应该是这样的 "),t("code",[e._v("/etc/nginx/conf.d/kaifazhinan.com.conf")]),e._v("，如果你在一个服务器中部署多个服务，当然你也可以在文件名中加上 Nginx 转发的端口号，比如 "),t("code",[e._v("kaifazhinan.com.3000.conf")]),e._v("，这样做看起来会更加友好。")]),e._v(" "),t("p",[e._v("如果你的配置中有很多重复的代码，那么建议你创建一个 /etc/nginx/snippets 文件夹，在这里面存放所有会被复用的代码块，然后在各个需要用到的 Nginx 的配置文件中引用进去，这样可以更方便管理和修改。")]),e._v(" "),t("p",[e._v("Nginx 日志文件（"),t("code",[e._v("access.log")]),e._v(" 和 "),t("code",[e._v("error.log")]),e._v(" ）位于 "),t("code",[e._v("/var/log/nginx/")]),e._v("目录中。建议为每个独立的服务配置不同的访问权限和错误日志文件，这样查找错误时，会更加方便快捷。")]),e._v(" "),t("p",[e._v("你可以将要部署的代码文件，存储在任何你想的位置，但是一般推荐存放在下列位置中的其中一个：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("/home/<user_name>/<site_name>\n/var/www/<site_name>\n/var/www/html/<site_name>\n/opt/<site_name>\n/usr/share/nginx/html\n")])])]),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),t("p",[e._v("首先恭喜你，你已经成功的在 CentOS 7 上安装了 Nginx 服务，你现在可以在你的服务器中通过 Nginx 部署你的服务代码啦")])])},[],!1,null,null,null);n.default=a.exports}}]);